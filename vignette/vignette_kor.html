<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>seoulsubway</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">seoulsubway</h1>
<h4 class="author"><em><div style="white-space: pre-line;">KwangMin Son
Department of Statistics, SKKU</div></em></h4>



<div id="----" class="section level3">
<h3>패키지 불러들이기 &amp; 패키지 내장 데이터소개</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#devtools::install_github(&quot;king4k1/seoulsubway&quot;)</span>
<span class="kw">library</span>(seoulsubway)</code></pre></div>
<pre><code>## Loading required package: tidyverse</code></pre>
<pre><code>## -- Attaching packages ----------------------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## √ ggplot2 3.1.0     √ purrr   0.2.5
## √ tibble  1.4.2     √ dplyr   0.7.8
## √ tidyr   0.8.2     √ stringr 1.3.1
## √ readr   1.3.0     √ forcats 0.3.0</code></pre>
<pre><code>## -- Conflicts -------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Loading required package: ggmap</code></pre>
<pre><code>## Loading required package: readxl</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;subway_sample&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;subway_data&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;transfer_info&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;transfer_station&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;seoul_station&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;seoul_route&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;subway_route&quot;</span>)

<span class="co"># subway_sample은 5000건의 샘플 경로를 포함합니다.</span>
<span class="kw">head</span>(subway_sample)</code></pre></div>
<pre><code>##    ID up_Line  up_Name down_Line down_Name Time Count
## 1 ID1       7     중계         2      방배    9     1
## 2 ID2       2 홍대입구         2      잠실   11     1
## 3 ID3       2   왕십리         2  잠실나루   10     1
## 4 ID4       6     합정         6    이태원   10     1
## 5 ID5       5     행당         1      서울    8     1
## 6 ID6       2     선릉         7      하계   10     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># transfer_info는 환승역, 환승거리 및 소요시간 정보(서울교통공사 17.10 기준) 내용을 포함합니다. 이때 제공되지 않는 정보에 대하여 평균 환승시간 2.35(2분 21초) 입력하였습니다.</span>
<span class="co"># 이세중. 환승 소요시간이 평균 2분 21초임을 고려해... [http://news.kbs.co.kr/news/view.do?ncd=3501669]</span>
<span class="kw">head</span>(transfer_info)</code></pre></div>
<pre><code>##    Transfer_Name Transfer_Line Transfer_Dist Transfer_Time Transfer_Line2
## 1       가락시장             3            35           0.5              8
## 2       가락시장             8            35           0.5              3
## 3 가산디지털단지             7           110          1.53            1-P
## 4 가산디지털단지           1-P           110          1.53              7
## 5           강남             2           214          2.97              S
## 6           강남             S           214          2.97              2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># transfer_station은 모든 환승가능한 역에 대한 정보를 포함합니다.</span>
<span class="kw">head</span>(transfer_station)</code></pre></div>
<pre><code>##              Name       lat       long Transfer
## 1        가락시장 37.492522 127.118234      3|8
## 3  가산디지털단지 37.481072 126.882343    1-P|7
## 5            가좌 37.568491 126.915487     K|K2
## 7            강남 37.497175 127.027926      2|S
## 9        강남구청 37.517186  127.04128      7|B
## 11           강동 37.535804 127.132481    5|5-A</code></pre>
</div>
<div id="----" class="section level3">
<h3>최단거리 함수 내 내장함수 소개</h3>
<div id="get_pathinfo------." class="section level4">
<h4><code>get_pathinfo()</code>는 두 역 사이의 이동역수와 소요시간을 산출합니다.</h4>
<ul>
<li>2호선의 경우 순환하는 것을 고려하는 단계를 추가하여 제작하였습니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_pathinfo</span>(<span class="dt">total=</span><span class="kw">nrow</span>(subway_data[[<span class="st">&quot;2&quot;</span>]]), <span class="dt">ind1=</span><span class="dv">10</span>, <span class="dt">ind2=</span><span class="dv">15</span>, <span class="dt">line=</span><span class="st">&quot;2&quot;</span>)</code></pre></div>
<pre><code>##   count  time
## 1     5 10.91</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 위 결과는 2호선 내 10번째 역과 15번째 역 사이의 소요시간과 이동회수를 산출하였습니다.</span></code></pre></div>
</div>
<div id="get_transfercriteria---------." class="section level4">
<h4><code>get_transfercriteria()</code>는 두 역 사이의 위경도를 기준으로 모든 환승가능한 역을 산출합니다.</h4>
<ul>
<li>이때 penalty를 통하여 좀 더 넓은 기준을 주어 선택할 수 있으며 이는 분기점의 경우 위경도를 기준으로 산출하였을 시 환승가능한 역이 나오지 않는 경우를 대비하여 argument로 두었습니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_transfercriteria</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">penalty=</span><span class="fl">0.05</span>)</code></pre></div>
<pre><code>##                   Name       lat       long Transfer
## 13            건대입구 37.540693  127.07023      2|7
## 24                군자 37.557121 127.079542      5|7
## 34                노원 37.655128 127.061368      4|7
## 45              동대문  37.57142 127.009745      1|4
## 47  동대문역사문화공원 37.565138 127.007896    2|4|5
## 50              동묘앞 37.572627 127.016429      1|6
## 61                보문 37.585286 127.019381     6|UI
## 68              삼각지 37.534777  126.97311      4|6
## 70                상봉 37.596362 127.085032      7|K
## 72                서울 37.554648 126.972559   1|4|K2
## 74                석계 37.614805 127.065851      1|6
## 80                성수 37.544581 127.055961    2|2-A
## 82        성신여대입구 37.592624 127.016403     4|UI
## 87                시청 37.564718 126.977108      1|2
## 91                신당 37.565972  127.01782      2|6
## 96              신설동 37.575297 127.025087 1|2-A|UI
## 99                약수  37.55434 127.010655      3|6
## 109               옥수 37.540685 127.017965      3|K
## 113             왕십리 37.561533 127.037732  2|5|B|K
## 119          을지로3가 37.566295  126.99191      2|3
## 121          을지로4가 37.566941 126.998079      2|5
## 131            종로3가 37.571607 126.991806    1|3|5
## 136               창동 37.653166 127.047731      1|4
## 138               천호 37.538397 127.123572      5|8
## 140               청구 37.560245 127.013828      5|6
## 142             청량리 37.580178 127.046835      1|K
## 145             충무로 37.561243  126.99428      3|4
## 147             충정로 37.559973 126.963672      2|5
## 149           태릉입구 37.617983  127.07512      6|7
## 155               회기  37.58946 127.057583      1|K
## 157         효창공원앞 37.539261 126.961351      6|K</code></pre>
</div>
<div id="get_transferinfo-------." class="section level4">
<h4><code>get_transferinfo()</code>는 두 역 사이의 모든 환승가능한 역을 산출합니다.</h4>
<ul>
<li><p>이때 count를 통하여 1,2,3번의 환승의 경우에 해당하는 환승 route를 제공합니다. 이 함수는 물론 get_transfercriteria가 매 단계 반복되는 구조로 제작하였습니다.(공간을 제약하는 방식을 사용합니다.)</p></li>
<li><p>함수 내부에 <code>checkline()</code> 이라는 함수를 두어 각 단계별 depart_line과 arrival_line을 기준으로 환승가능한 역에 대한 정확한 정보만을 선택하는 과정을 두었습니다.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_transferinfo</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, 
                 <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;4&quot;</span>, <span class="dt">count=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_transferinfo</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, 
                 <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;4&quot;</span>, <span class="dt">count=</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## $`1-1-1`
## $`1-1-1`$first
##        Name       lat      long Transfer
## 13 건대입구 37.540693 127.07023      2|7
## 
## $`1-1-1`$second
##                  Name       lat       long Transfer
## 47 동대문역사문화공원 37.565138 127.007896    2|4|5
## 
## 
## $`2-1-1`
## $`2-1-1`$first
##    Name       lat       long Transfer
## 24 군자 37.557121 127.079542      5|7
## 
## $`2-1-1`$second
##                  Name       lat       long Transfer
## 47 동대문역사문화공원 37.565138 127.007896    2|4|5
## 
## 
## $`3-1-2`
## $`3-1-2`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-2`$second
##      Name      lat       long Transfer
## 45 동대문 37.57142 127.009745      1|4
## 
## 
## $`3-1-3`
## $`3-1-3`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-3`$second
##                  Name       lat       long Transfer
## 47 동대문역사문화공원 37.565138 127.007896    2|4|5
## 
## 
## $`3-1-4`
## $`3-1-4`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-4`$second
##      Name       lat      long Transfer
## 68 삼각지 37.534777 126.97311      4|6
## 
## 
## $`3-1-5`
## $`3-1-5`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-5`$second
##    Name       lat       long Transfer
## 72 서울 37.554648 126.972559   1|4|K2
## 
## 
## $`3-1-6`
## $`3-1-6`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-6`$second
##            Name       lat       long Transfer
## 82 성신여대입구 37.592624 127.016403     4|UI
## 
## 
## $`3-1-7`
## $`3-1-7`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-7`$second
##     Name       lat       long Transfer
## 136 창동 37.653166 127.047731      1|4
## 
## 
## $`3-1-8`
## $`3-1-8`$first
##    Name       lat       long Transfer
## 34 노원 37.655128 127.061368      4|7
## 
## $`3-1-8`$second
##       Name       lat      long Transfer
## 145 충무로 37.561243 126.99428      3|4
## 
## 
## $`5-1-1`
## $`5-1-1`$first
##         Name       lat      long Transfer
## 149 태릉입구 37.617983 127.07512      6|7
## 
## $`5-1-1`$second
##      Name       lat      long Transfer
## 68 삼각지 37.534777 126.97311      4|6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_transferinfo</span>(<span class="dt">depart=</span><span class="st">&quot;강동&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;5-A&quot;</span>, 
                 <span class="dt">arrival=</span><span class="st">&quot;봉화산&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;6&quot;</span>, <span class="dt">count=</span><span class="dv">3</span>)</code></pre></div>
<pre><code>## $`1-1-1-1-1`
## $`1-1-1-1-1`$first
##    Name       lat       long Transfer
## 11 강동 37.535804 127.132481    5|5-A
## 
## $`1-1-1-1-1`$second
##    Name       lat       long Transfer
## 24 군자 37.557121 127.079542      5|7
## 
## $`1-1-1-1-1`$third
##         Name       lat      long Transfer
## 149 태릉입구 37.617983 127.07512      6|7</code></pre>
</div>
</div>
<div id="-" class="section level3">
<h3>최단거리 함수</h3>
<div id="shortestpath_0--depart_line-arrival_line---." class="section level4">
<h4><code>shortestpath_0()</code> 는 depart_line과 arrival_line이 같은 경우만 작동합니다.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortestpath_0</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, <span class="dt">arrival=</span><span class="st">&quot;건대입구&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;7&quot;</span>)</code></pre></div>
<pre><code>## $Info
##   Depart Line Count  Time   Arrive
## 1   먹골    7     9 14.66 건대입구
## 
## $Count
## [1] 9
## 
## $Time
## [1] 14.66
## 
## $Path
##    Code         Name Line ExCode CyCode      X       Y      lat     long
## 10 2720         먹골    7    718   2720 516982 1141245 37.61064 127.0777
## 11 2721         중화    7    719   2721 517345 1138885 37.60254 127.0793
## 12 2722         상봉    7    720   2722 518665 1137145 37.59636 127.0850
## 13 2723         면목    7    721   2723 519095 1135127 37.58858 127.0875
## 14 2724       사가정    7    722   2724 519355 1132955 37.58089 127.0885
## 15 2725       용마산    7    723   2725 519027 1131010 37.57365 127.0867
## 16 2726         중곡    7    724   2726 518432 1128785 37.56592 127.0843
## 17 2727         군자    7    725   2545 517395 1126285 37.55712 127.0795
## 18 2728 어린이대공원    7    726   2728 516326 1123811 37.54801 127.0747
## 19 2729     건대입구    7    727    212 515365 1121815 37.54069 127.0702
##    Transfer    Dist Time
## 10        0  849.40 1.50
## 11        0  910.96 1.61
## 12        K  855.89 1.51
## 13        0  893.39 1.58
## 14        0  859.80 1.52
## 15        0  821.39 1.45
## 16        0  885.67 1.56
## 17        5 1066.70 1.88
## 18        0 1101.61 1.95
## 19        2  903.84 1.60</code></pre>
</div>
<div id="shortestpath_1---------." class="section level4">
<h4><code>shortestpath_1()</code> 는 환승을 한번만 하는 경로 중 최단거리 결과를 산출합니다.</h4>
<ul>
<li>get_transferinfo(…, count=1) 을 통하여 산출된 경로리스트를 후보군으로 최단경로를 선택합니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortestpath_1</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;4&quot;</span>)</code></pre></div>
<pre><code>## $Info
##   Depart Line Count  Time Arrive
## 1   먹골    7     5  9.63   노원
## 2   노원    4     9 19.61   혜화
## 
## $Count
## [1] 14
## 
## $Time
## [1] 36.11
## 
## $Path1
##    Code     Name Line ExCode CyCode      X       Y      lat     long
## 10 2720     먹골    7    718   2720 516982 1141245 37.61064 127.0777
## 9  2719 태릉입구    7    717   2646 516430 1143262 37.61798 127.0751
## 8  2718     공릉    7    716   2718 515927 1145312 37.62574 127.0729
## 7  2717     하계    7    715   2717 514942 1148310 37.63635 127.0680
## 6  2716     중계    7    714   2716 514005 1150745 37.64458 127.0643
## 5  2715     노원    7    713    411 513622 1153612 37.65513 127.0614
##    Transfer    Dist Time
## 10        0  849.40 1.50
## 9         6  885.71 1.56
## 8         0 1257.80 2.22
## 7         0  972.20 1.72
## 6         0 1202.03 2.12
## 5         4 1139.72 2.01
## 
## $Path2
##    Code         Name Line ExCode CyCode      X       Y      lat     long
## 3   411         노원    4    411    411 513622 1153612 37.65513 127.0614
## 4   412         창동    4    412    412 510370 1153032 37.65317 127.0477
## 5   413         쌍문    4    413    413 507572 1151735 37.64863 127.0347
## 6   414         수유    4    414    414 505477 1148677 37.63805 127.0257
## 7   415         미아    4    415    415 505667 1145592 37.62667 127.0260
## 8   416   미아사거리    4    416    416 506527 1141940 37.61329 127.0301
## 9   417         길음    4    417    417 505320 1139202 37.60341 127.0251
## 10  418 성신여대입구    4    418    418 503476 1136257 37.59262 127.0164
## 11  419   한성대입구    4    419    419 501130 1135052 37.58846 127.0062
## 12  420         혜화    4    420    420 500245 1133299 37.58234 127.0018
##    Transfer    Dist Time
## 3         7 1251.58 2.21
## 4         1 1221.55 2.16
## 5         0 1254.02 2.22
## 6         0 1418.43 2.51
## 7         0 1267.23 2.24
## 8         0 1531.86 2.71
## 9         0 1185.45 2.09
## 10       UI 1422.29 2.51
## 11        0 1010.80 1.79
## 12        0  783.28 1.38</code></pre>
</div>
<div id="shortestpath_2---------." class="section level4">
<h4><code>shortestpath_2()</code> 는 환승을 두번 하는 경로 중 최단거리 결과를 산출합니다.</h4>
<ul>
<li>get_transferinfo(…, count=2) 을 통하여 산출된 경로리스트를 후보군으로 최단경로를 선택합니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortestpath_2</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;4&quot;</span>)</code></pre></div>
<pre><code>## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length

## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length

## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length</code></pre>
<pre><code>## $Info
##               Depart Line Count  Time             Arrive
## 1               먹골    7     7 11.11               군자
## 2               군자    5     8 12.33 동대문역사문화공원
## 3 동대문역사문화공원    4     2  3.86               혜화
## 
## $Count
## [1] 17
## 
## $Time
## [1] 37.7
## 
## $Path1
##    Code   Name Line ExCode CyCode      X       Y      lat     long
## 10 2720   먹골    7    718   2720 516982 1141245 37.61064 127.0777
## 11 2721   중화    7    719   2721 517345 1138885 37.60254 127.0793
## 12 2722   상봉    7    720   2722 518665 1137145 37.59636 127.0850
## 13 2723   면목    7    721   2723 519095 1135127 37.58858 127.0875
## 14 2724 사가정    7    722   2724 519355 1132955 37.58089 127.0885
## 15 2725 용마산    7    723   2725 519027 1131010 37.57365 127.0867
## 16 2726   중곡    7    724   2726 518432 1128785 37.56592 127.0843
## 17 2727   군자    7    725   2545 517395 1126285 37.55712 127.0795
##    Transfer    Dist Time
## 10        0  849.40 1.50
## 11        0  910.96 1.61
## 12        K  855.89 1.51
## 13        0  893.39 1.58
## 14        0  859.80 1.52
## 15        0  821.39 1.45
## 16        0  885.67 1.56
## 17        5 1066.70 1.88
## 
## $Path2
##    Code               Name Line ExCode CyCode      X       Y      lat
## 35 2545               군자    5    544   2545 517395 1126285 37.55712
## 34 2544             장한평    5    543   2544 513985 1127595 37.56144
## 33 2543             답십리    5    542   2543 511330 1129032 37.56675
## 32 2542               마장    5    541   2542 509362 1128847 37.56610
## 31 2541             왕십리    5    540    208 508015 1127512 37.56153
## 30 2540               행당    5    539   2540 506397 1126405 37.55732
## 29 2539             신금호    5    538   2539 504357 1125662 37.55455
## 28 2538               청구    5    537   2538 502872 1127150 37.56025
## 27 2537 동대문역사문화공원    5    536    205 501555 1128600 37.56514
##        long Transfer    Dist Time
## 35 127.0795        7 1401.58 2.48
## 34 127.0646        0 1206.30 2.13
## 33 127.0527        0  861.65 1.52
## 32 127.0430        0  687.27 1.21
## 31 127.0377    2|B|K  866.33 1.53
## 30 127.0295        0  864.10 1.53
## 29 127.0203        0  855.29 1.51
## 28 127.0138        6  755.43 1.33
## 27 127.0079      2|4  889.18 1.57
## 
## $Path3
##    Code               Name Line ExCode CyCode      X       Y      lat
## 14  422 동대문역사문화공원    4    422    205 501555 1128600 37.56514
## 13  421             동대문    4    421    155 502155 1130180 37.57142
## 12  420               혜화    4    420    420 500245 1133299 37.58234
##        long Transfer    Dist Time
## 14 127.0079      2|5  718.09 1.27
## 13 127.0097        1 1400.90 2.48
## 12 127.0018        0  783.28 1.38</code></pre>
</div>
<div id="shortestpath_3---------." class="section level4">
<h4><code>shortestpath_3()</code> 는 환승을 세번 하는 경로 중 최단거리 결과를 산출합니다.</h4>
<ul>
<li>get_transferinfo(…, count=3) 을 통하여 산출된 경로리스트를 후보군으로 최단경로를 선택합니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortestpath_3</span>(<span class="dt">depart=</span><span class="st">&quot;강동&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;5-A&quot;</span>, 
               <span class="dt">arrival=</span><span class="st">&quot;봉화산&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;6&quot;</span>)</code></pre></div>
<pre><code>## $Info
##     Depart Line Count  Time   Arrive
## 1     강동  5-A     0  0.00     강동
## 2     강동    5     4 10.29     군자
## 3     군자    7     8 12.29 태릉입구
## 4 태릉입구    6     2  2.73   봉화산
## 
## $Count
## [1] 14
## 
## $Time
## [1] 37.28
## 
## $Path1
##     Code Name Line ExCode CyCode      X       Y       lat       long
## 176 2549 강동  5-A    548   2549 529040 1120490 37.535804 127.132481
##     Transfer Dist Time
## 176        5    0    0
## 
## $Path2
##    Code   Name Line ExCode CyCode      X       Y      lat     long
## 39 2549   강동    5    548   2549 529040 1120490 37.53580 127.1325
## 38 2548   천호    5    547   2548 527042 1121095 37.53840 127.1236
## 37 2547 광나루    5    546   2547 522710 1123015 37.54530 127.1036
## 36 2546 아차산    5    545   2546 519537 1125055 37.55169 127.0898
## 35 2545   군자    5    544   2545 517395 1126285 37.55712 127.0795
##    Transfer    Dist Time
## 39      5-A  837.71 1.48
## 38        8 1925.62 3.40
## 37        0 1411.05 2.49
## 36        0 1085.68 1.92
## 35        7 1401.58 2.48
## 
## $Path3
##    Code     Name Line ExCode CyCode      X       Y      lat     long
## 17 2727     군자    7    725   2545 517395 1126285 37.55712 127.0795
## 16 2726     중곡    7    724   2726 518432 1128785 37.56592 127.0843
## 15 2725   용마산    7    723   2725 519027 1131010 37.57365 127.0867
## 14 2724   사가정    7    722   2724 519355 1132955 37.58089 127.0885
## 13 2723     면목    7    721   2723 519095 1135127 37.58858 127.0875
## 12 2722     상봉    7    720   2722 518665 1137145 37.59636 127.0850
## 11 2721     중화    7    719   2721 517345 1138885 37.60254 127.0793
## 10 2720     먹골    7    718   2720 516982 1141245 37.61064 127.0777
## 9  2719 태릉입구    7    717   2646 516430 1143262 37.61798 127.0751
##    Transfer    Dist Time
## 17        5 1066.70 1.88
## 16        0  885.67 1.56
## 15        0  821.39 1.45
## 14        0  859.80 1.52
## 13        0  893.39 1.58
## 12        K  855.89 1.51
## 11        0  910.96 1.61
## 10        0  849.40 1.50
## 9         6  885.71 1.56
## 
## $Path4
##    Code     Name Line ExCode CyCode      X       Y      lat     long
## 31 2646 태릉입구    6    645   2646 516430 1143262 37.61798 127.0751
## 32 2647   화랑대    6    646   2647 518457 1143835 37.62006 127.0847
## 33 2648   봉화산    6    647   2648 520005 1143042 37.61728 127.0914
##    Transfer   Dist Time
## 31        7 890.60 1.57
## 32        0 874.97 1.55
## 33        0 667.91 1.18</code></pre>
</div>
<div id="shortestpath----." class="section level4">
<h4><code>shortestpath()</code> 는 지하철 최단경로를 제공합니다.</h4>
<ul>
<li><p>위 결과 중 depart_line==arrival_line의 경우, <code>shortestpath_0()</code>이 작동하고, depart_line!=arrival_line의 경우 환승을 두번까지 하는 방법 중 최단시간경로를 제공합니다.</p></li>
<li><p>만약 환승을 2번까지 하여도 나오지 않는 경로에 대하여는 <code>shortestpath_3()</code>이 작동한 결과를 산출합니다.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortestpath</span>(<span class="dt">depart=</span><span class="st">&quot;강동&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;5-A&quot;</span>, 
               <span class="dt">arrival=</span><span class="st">&quot;봉화산&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;6&quot;</span>)</code></pre></div>
<pre><code>## $Info
##     Depart Line Count  Time   Arrive
## 1     강동  5-A     0  0.00     강동
## 2     강동    5     4 10.29     군자
## 3     군자    7     8 12.29 태릉입구
## 4 태릉입구    6     2  2.73   봉화산
## 
## $Count
## [1] 14
## 
## $Time
## [1] 37.28
## 
## $Path1
##     Code Name Line ExCode CyCode      X       Y       lat       long
## 176 2549 강동  5-A    548   2549 529040 1120490 37.535804 127.132481
##     Transfer Dist Time
## 176        5    0    0
## 
## $Path2
##    Code   Name Line ExCode CyCode      X       Y      lat     long
## 39 2549   강동    5    548   2549 529040 1120490 37.53580 127.1325
## 38 2548   천호    5    547   2548 527042 1121095 37.53840 127.1236
## 37 2547 광나루    5    546   2547 522710 1123015 37.54530 127.1036
## 36 2546 아차산    5    545   2546 519537 1125055 37.55169 127.0898
## 35 2545   군자    5    544   2545 517395 1126285 37.55712 127.0795
##    Transfer    Dist Time
## 39      5-A  837.71 1.48
## 38        8 1925.62 3.40
## 37        0 1411.05 2.49
## 36        0 1085.68 1.92
## 35        7 1401.58 2.48
## 
## $Path3
##    Code     Name Line ExCode CyCode      X       Y      lat     long
## 17 2727     군자    7    725   2545 517395 1126285 37.55712 127.0795
## 16 2726     중곡    7    724   2726 518432 1128785 37.56592 127.0843
## 15 2725   용마산    7    723   2725 519027 1131010 37.57365 127.0867
## 14 2724   사가정    7    722   2724 519355 1132955 37.58089 127.0885
## 13 2723     면목    7    721   2723 519095 1135127 37.58858 127.0875
## 12 2722     상봉    7    720   2722 518665 1137145 37.59636 127.0850
## 11 2721     중화    7    719   2721 517345 1138885 37.60254 127.0793
## 10 2720     먹골    7    718   2720 516982 1141245 37.61064 127.0777
## 9  2719 태릉입구    7    717   2646 516430 1143262 37.61798 127.0751
##    Transfer    Dist Time
## 17        5 1066.70 1.88
## 16        0  885.67 1.56
## 15        0  821.39 1.45
## 14        0  859.80 1.52
## 13        0  893.39 1.58
## 12        K  855.89 1.51
## 11        0  910.96 1.61
## 10        0  849.40 1.50
## 9         6  885.71 1.56
## 
## $Path4
##    Code     Name Line ExCode CyCode      X       Y      lat     long
## 31 2646 태릉입구    6    645   2646 516430 1143262 37.61798 127.0751
## 32 2647   화랑대    6    646   2647 518457 1143835 37.62006 127.0847
## 33 2648   봉화산    6    647   2648 520005 1143042 37.61728 127.0914
##    Transfer   Dist Time
## 31        7 890.60 1.57
## 32        0 874.97 1.55
## 33        0 667.91 1.18</code></pre>
</div>
</div>
<div id="---" class="section level3">
<h3>최단거리 함수를 이용한 분석함수</h3>
<div id="get_path-----binary--." class="section level4">
<h4><code>get_path()</code> 는 지하철 최단경로에 해당하는 binary한 결과를 산출합니다.</h4>
<ul>
<li><code>get_path()</code> 함수를 통하여 (1) 이동경로에 해당하는 역명과 (2) 총 460개의 역을 한글순서로 정렬한 역에 해당하는 index를 산출합니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_path</span>(<span class="dt">depart=</span><span class="st">&quot;먹골&quot;</span>, <span class="dt">depart_line=</span><span class="st">&quot;7&quot;</span>, <span class="dt">arrival=</span><span class="st">&quot;혜화&quot;</span>, <span class="dt">arrival_line=</span><span class="st">&quot;4&quot;</span>)</code></pre></div>
<pre><code>## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length

## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length

## Warning in stri_detect_regex(string, pattern, opts_regex = opts(pattern)):
## longer object length is not a multiple of shorter object length</code></pre>
<pre><code>##            Path ind
## 1          먹골  32
## 2      태릉입구  68
## 3          공릉  82
## 4          하계 149
## 5          중계 162
## 6          노원 163
## 7          창동 241
## 8          쌍문 260
## 9          수유 292
## 10         미아 396
## 11   미아사거리 410
## 12         길음 427
## 13 성신여대입구 435
## 14   한성대입구 441
## 15         혜화 447</code></pre>
<ul>
<li><p><code>get_path()</code>를 통하여 2018.4월 데이터 중 유일한 역과 호선에 대한 쌍을 담고 있는 seoul_route(277가지 경우)에 대하여 <code>subway_route</code>를 제작하였습니다.</p></li>
<li><p><code>subway_route</code> 내에는 “출발역(출발호선)-도착역(도착호선)” 의 경우에 해당하는 총 37875가지의 경로에 대한 정보가 포함되어있습니다.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(seoul_route)</code></pre></div>
<pre><code>##             Name Line
## 1       가락시장    8
## 2       가락시장    3
## 3 가산디지털단지    7
## 4           강남    2
## 5       강남구청    7
## 6           강동    5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subway_route[[<span class="st">&quot;가락시장(8)-강남(2)&quot;</span>]]</code></pre></div>
<pre><code>##          Path ind
## 1    가락시장   3
## 2        송파  10
## 3        석촌 203
## 4        잠실 233
## 5    잠실새내 234
## 6  종합운동장 252
## 7        삼성 323
## 8        선릉 374
## 9        역삼 376
## 10       강남 392</code></pre>
</div>
<div id="get_total_count--subway_route------." class="section level4">
<h4><code>get_total_count()</code> 는 subway_route를 통하여 데이터셋에 기반한 누적 경유회수를 산출합니다.</h4>
<ul>
<li><p><code>subway_route</code>의 37875가지 경우는 277X277행렬의 하삼각행렬으로써 만약 경로가 없다면 상삼각행렬의 해당하는 경로를 산출하는 “도착역(도착호선)-출발역(출발호선)” 의 경우를 산출합니다.</p></li>
<li><p><code>subway_sample</code> 을 이용하여 5000개의 경로에 대한 누적결과를 산출하는데 5분 이내의 시간이 소요되는 것을 확인하였습니다.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">total_count &lt;-<span class="st"> </span><span class="kw">get_total_count</span>(<span class="dt">dat=</span>subway_sample, <span class="dt">depart_name =</span> <span class="st">&quot;up_Name&quot;</span>, <span class="dt">depart_line_name =</span> <span class="st">&quot;up_Line&quot;</span>, <span class="dt">arrival_name =</span> <span class="st">&quot;down_Name&quot;</span>, <span class="dt">arrival_line_name =</span> <span class="st">&quot;down_Line&quot;</span>)</code></pre></div>
<pre><code>## Started at : 2018-12-22 20:12:56 / ...ing...Finished..! / elapsed time : 6.05719343026479</code></pre>
<ul>
<li>산출된 결과를 5000개의 경로에 대한 정보를 total_count에 저장한 후 500count 이상을 기록한 지하철역만을 산출하여 그림으로 그려보았습니다. 이러한 방식으로 다음단계의 분석이 가능할 것 같습니다.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">total_count_upper500 &lt;-<span class="st"> </span>total_count[<span class="kw">which</span>(total_count<span class="op">&gt;=</span><span class="dv">500</span>)]
total_count_upper500 &lt;-<span class="st"> </span>total_count_upper500<span class="op">%&gt;%</span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;station&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;count&quot;</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>total_count_upper500, <span class="kw">aes</span>(<span class="dt">x=</span>station, <span class="dt">y=</span>count, <span class="dt">fill =</span> station)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
